
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.11.2/HERE_NOTICE
 */

H.util.eval("function En(a,b){if(!a)throw new D(En,0,a);En.l.constructor.call(this,a);this.b={};this.c=b&&b.uc;this.f=Fn++}u(En,Sl);var Fn=0;\nEn.prototype.W=function(a,b,c,d,e,f){var g=rd(d),h=this.hb,k=g+(c.exp-h.pixelProjection.exp),l=h.min,m=h.max;d=h.tileSize;var p=h.ja().j,q=this.Kb,r=q.Yc();var v=q.Fb().w;var w=c.w,y=c.x,H=c.y,G={};if(g<l||g>m)return Ij.DONE;e=h.requestTiles(a,k,e,f,this.f);a=e.total;e=e.tiles;f=e.length;this.g=c;this.i=b;this.a=k;r!==p&&q.pc(p);c=d=d*w/(xd(2,k)*d);this.c||(d%1&&(d=sd(d),w=c/d,y/=w,H/=w,w=xd(2,k)*d),y=sd(y),H=sd(H));this.j=c;k=-d;g=v+d;for(h=0;h<f;h++){v=e[h];if((l=v.data)&&l.tagName){c=b.x-(y-v.x*\nd);p=b.y-(H-v.y*d);q.Vc(l,c,p,d,d);for(r=c;(r-=w)>k;)q.Vc(l,r,p,d,d);for(r=c;(r+=w)<g;)q.Vc(l,r,p,d,d)}G[this.a+\"_\"+v.x+\"_\"+v.y]=v}this.b=G;return f===a?Ij.DONE:Ij.PENDING};En.prototype.Ia=function(a,b,c){var d=this.j,e=d/this.hb.tileSize,f=this.g,g=this.i,h;if(nc(this.a)&&f){a=f.x+(a-g.x);b=f.y+(b-g.y);var k=sd(f.w/d);var l=f=sd(a/d);g=sd(b/d);ud(l)>=k&&(l%=k);0>l&&(l=k+l);(k=this.b[this.a+\"_\"+l+\"_\"+g])&&k.Ia&&(h=k.Ia((a-d*f)/e,(b-d*g)/e,c))}return h||Ye};En.prototype.Ud=function(){return\"2d\"};function Gn(a,b){b=b||{};C(a,Tk,Gn,0);Gn.l.constructor.call(this,a);this.uc=!!b.uc;this.c=b.ib||0;this.a=[];this.b={}}u(Gn,Sl);\nGn.prototype.W=function(a,b,c,d,e,f){var g,h=this.hb,k;d-=this.c;this.a.length=0;var l=this.b;this.b=g={};if(d>=h.min&&d<=h.max){var m=h.wd(a,d,e,f);var p=m.overlays;if(a=p.length)for(p.sort(Hg),d=this.Kb,e=this.uc,f=0;f<a;f++){h=p[f];var q=h.G();var r=c.lb(q.Vb());var v=c.lb(q.Sb());q=c.w;r.x>=v.x&&(r.x-=q);q=-((r.x+v.x)/q>>1)*q;r.x+=q;r.add(b);v.x+=q;v.add(b);e||(r.round(),v.round());(q=l[k=h.eb()])?delete l[k]:q={In:h};g[k]=q;var w=r.x;r=r.y;var y=v.x;v=v.y;var H=y-w;var G=v-r;d.pc(h.Yc());d.Vc(h.Wc(),\nw,r,H,G);q.$g?q.$g.set(w,r,y,v):q.$g=new Kj(w,r,y,v);this.a.push(q)}}return!m||m.requested&&m.requested===m.total||!m.requested&&p.length===m.total?Ij.DONE:Ij.PENDING};Gn.prototype.Ia=function(a,b,c){for(var d=this.a,e=d.length,f,g,h;e--;)if(f=d[e],g=f.$g,g.Hf(a,b))if(f=f.In,h)h.push(f);else if(h=[f],c)break;return h||Ye};Gn.prototype.Ud=function(){return\"2d\"};Gn.prototype.u=function(){this.a=null;Gn.l.u.call(this)};var Hn={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:al.ZOOM,COORD:al.COORD},capture:!0};t(\"H.map.render.p2d.capabilities\",Hn);function In(a,b){this.a=[];In.l.constructor.apply(this,arguments)}u(In,Yl);n=In.prototype;n.sj=function(){return this.hb.Ic.apply(this.hb,arguments)};n.W=function(a,b,c,d,e,f,g){this.a=[];return In.l.W.apply(this,arguments)};n.Wj=1;n.yk=function(a,b,c,d,e,f){var g=this.Wj=d.gb();e*=g;f*=g;var h=c.Fb();b=h.w*g;h=h.h*g;var k=c.md();this.uc?(e-=k.x*g,f-=k.y*g):(e=rd(e-k.x*g),f=rd(f-k.y*g));d.Vc(c.Wc(),e,f,b,h);a.detail?a.detail.set(e,f,e+b,f+h):a.detail=new Kj(e,f,e+b,f+h);this.a.push(a)};\nn.Ia=function(a,b,c){for(var d=this.a,e=d.length,f,g,h,k=Ye,l=this.Wj;e--&&!(f=d[e],g=f.detail,g.Hf(a,b)&&(f=f.ek,(!(h=f.Db().g)||h.Yf((a-g.left)/l,(b-g.top)/l,0))&&0>k.indexOf(f)&&(k===Ye&&(k=[]),k.push(f),c))););return k};n.Ud=function(){return\"2d\"};n.u=function(){this.a=null;In.l.u.call(this)};function U(a,b,c,d){U.l.constructor.call(this,a,b,c,d);this.I=new I(0,0);if(c=d.renderBaseBackground)this.Bn=c.lower,this.mn=c.higher;this.kn=!!d.enableSubpixelRendering;this.Dd=Jn;this.Gj=0;this.Ld=this.Of=!1;this.m=new ul;this.a=d=new Il;this.Ed=A(this.Ed,this);d.addEventListener(d.g.Gg,this.Ed);this.Ha=A(this.Ha,this);d=a.element;this.bb=a=d.ownerDocument.createElement(\"div\");a.style.position=\"absolute\";a.style.width=a.style.height=\"100%\";a.style.zIndex=0;d.insertBefore(a,d.firstChild);this.Jj=\nnew jm(this.bb,this.na);this.v=[];Kn(this);this.Rh=A(U.prototype.Rh,this);this.A=Ln;this.df();this.zoom=Mn(this,this.K.sb()+this.ib);this.Nb();Nn(this,b.rb().position,this.zoom);dl(this);this.sa()}u(U,Xk);t(\"H.map.render.p2d.RenderEngine\",U);U.prototype.type=hl.P2D;U.prototype.type=U.prototype.type;var Ln=2;U.prototype.getState=function(){return this.A};U.prototype.getState=U.prototype.getState;function On(a,b,c){b=c-b;return ud(b)<a.b.w/2?b:b-a.b.w*c/ud(c)}\nU.prototype.Wg=function(a){var b=this,c=a.b,d=a.newValue,e=a.modifiers,f=d.position,g=d.bounds,h,k=this.zoom,l=this.c,m=0;e&a.gd&&(h=b.b.lb(f));if(e&a.Hg)a=Pn(this,g.G(),e&a.pe?d.zoom:B,e&a.gd?f:B),this.K.dc(a,c);else{e&a.gd||(h=b.b.lb(d.position));var p=h.x;var q=h.y;Qn(this);this.I.set(0,0);a=Rn(this,d);var r=a.zoom;var v=a.position;if(c){var w=r-k;var y={x:l.x,y:l.y};c=this.b.ad(y).x;var H=this.b.projection.Rb(f);if(H.x!==this.c.x||H.y!==this.c.y||r!==this.zoom)p=On(this,c,p),Sn(this,function(G){var V=\nG-m;if(r!==k){h=b.b.ad(H);var R=b.b.ad(y);p=On(b,R.x,h.x);q=h.y-R.y}m=G;Tn(b,p*V,q*V);k+=w*V;Un(b,k);dl(b);b.ka()},this.yb,function(){Nn(b,v,r);Un(b,r);dl(b,v);b.ka()},this.zb)}else Vn(this),Nn(this,v,r),Un(this,r),dl(this,v);this.ka()}};U.prototype.yb=300;U.prototype.hf=function(a){var b=wc(a);if(!b||b&&0>a)throw new D(this.hf,1,\"positive number required\");this.yb=a};U.prototype.setAnimationDuration=U.prototype.hf;U.prototype.hh=function(){return this.yb};U.prototype.getAnimationDuration=U.prototype.hh;\nU.prototype.zb=Vl;U.prototype.jf=function(a){if(!va(a))throw new D(this.jf,1,\"function required\");this.zb=a};U.prototype.setAnimationEase=U.prototype.jf;U.prototype.ih=function(){return this.zb};U.prototype.getAnimationEase=U.prototype.ih;U.prototype.df=function(){this.zb=Vl;this.yb=300};U.prototype.resetAnimationDefaults=U.prototype.df;\nU.prototype.ci=function(a,b,c){var d;this.ab=Vj();(d=this.ba.ca.splice(a,1)[0])&&d.C&&d.C();(d=this.s.ca.splice(a,1)[0])&&d.C&&d.C();(d=this.ga.ca.splice(a,1)[0])&&d.C&&d.C();(d=this.S.ca.splice(a,1)[0])&&d.C&&d.C();this.g=this.f.Pa();0===a&&(bl(this,b,!1),this.Nb());this.v=km(this.Jj,Wn(this),Xn(this));this.fe();c||this.ka()};function Kn(a){var b=a.f.Pa(),c=0,d=b.length;[a.ba={},a.s={},a.ga={},a.S={}].forEach(function(e){e.Uc=[];e.ca=[]});for(a.g=a.f.Pa();c<d;c++)a.Te(c,b[c]);a.Nb()}\nU.prototype.di=function(){this.Nb();this.ka()};U.prototype.Bh=function(a,b,c){var d,e,f,g;if(b){var h={uc:this.kn,ib:this.ib};b.W?C(b,Ul)?e=new Tl(b):C(b,hm)&&(g=new Tl(b)):(b.requestOverlays&&(d=new Gn(b,h)),b.requestTiles&&(e=new En(b,h)),b.requestMarkers&&(f=new In(b,h)),b.requestDomMarkers&&(g=new am(b,h)))}c=c||0;this.ba.ca.splice(a,c,d);this.s.ca.splice(a,c,e);this.ga.ca.splice(a,c,f);this.S.ca.splice(a,c,g);this.g=this.f.Pa();this.v=km(this.Jj,Wn(this),Xn(this))};\nfunction Xn(a){var b=[];b=b.concat(a.s.ca);b=b.concat(a.ba.ca);b=b.concat(a.ga.ca);b=b.concat(a.S.ca);return b=b.filter(nc)}function Rn(a,b){var c=cl(a,cl(a,b.zoom)+a.ib);a=el(a,b);a.zoom=c;return a}function Nn(a,b,c){var d=a.b;d.Fa(c);a.c=d.projection.Rb(b);d.x=d.w*a.c.x;d.y=d.h*a.c.y}U.prototype.Xa=function(a,b){var c=this.i.center,d=this.na;return this.b.Sa((a-c.x)*d,(b-c.y)*d)};U.prototype.screenToGeo=U.prototype.Xa;U.prototype.vg=function(a,b){a=this.Xa(a,b);b=this.K.rb();b.position=a;return b};\nU.prototype.Ha=function(a){var b=this.na,c=this.i.center,d=c.x*b;c=c.y*b;a=this.b.lb(a);var e=this.b.w;return new I(rd((a.x-rd(a.x/e)*e+d)/b),rd((a.y+c)/b))};U.prototype.geoToScreen=U.prototype.Ha;U.prototype.G=function(a,b){var c=this.Lb[a||4];a=this.b;var d=c.left-b,e=a.Sa(d,c.top-b),f=c.right+b;b=a.Sa(f,c.bottom+b);f-d>=a.w&&(e.lng=-(b.lng=180));return Wf(e,b)};\nU.prototype.Ia=function(a,b,c,d){var e=[],f=this.na,g;a*=f;b*=f;f=[this.ba,this.s,this.ga,this.S];for(g=f.length;g--&&(!c||!e.length);){for(var h=e,k=f[g].ca,l=a,m=b,p=c,q=k.length;q--&&!((e=k[q])&&e.Ia&&(h=h.concat(e.Ia(l,m,p)),h.length&&p)););e=h}d(e)};U.prototype.getObjectsAt=U.prototype.Ia;U.prototype.gc=z;function Wn(a){a=a.Lb[2];return{w:a.right-a.left,h:a.bottom-a.top}}\nU.prototype.sa=function(){var a=this.v.length,b;U.l.sa.call(this);var c=Wn(this);this.I.set(0,0);var d=c.w;for(b=c.h;a--;){c=this.v[a];var e=c.Fb();e.w===d&&e.h===b||Pl(c,d,b)}this.gc=new Ch(d,b);this.ka()};U.prototype.getCapabilities=function(){return Hn};U.prototype.getCapabilities=U.prototype.getCapabilities;function Yn(a){Vj()-a.ab<a.Dd&&!a.D?a.Ig=gk(a.Rh):(a.D&&(a.fe(),Zn(a)),a.A=Ln)}n=U.prototype;n.fe=function(){this.ba.Uc.length=0;this.s.Uc.length=0;this.ga.Uc.length=0;this.S.Uc.length=0};\nn.Rh=function(){var a;this.F&&this.F.before();var b=this.s.ca;var c=this.i.center.clone().scale(this.na).round();var d=this.G(1,0);var e=this.G(1,$n);var f=this.zoom;var g=f-this.ib;var h=this.b;var k=this.Bn;var l=this.mn;var m=b[0];b=this.I;var p=this.v.length;var q=this.g;for(a=q.length;p--;){var r=this.v[p];C(r,Rl)&&r.clear()}if(m){if(k)for(;k;)p=f-k,m.W(d,c,h,p,!0,b),--k;if(l&&this.Ld)for(r=1;r<=l&&(p=f+r,h.Fa(p),k=this.G(2,0),h.Fa(f),!m.W(k,c,h,p,!0,b));r++);}for(this.Dd=Jn;a--;)h=q[a],C(h,\npi)&&h.ja()&&h.ja().ii(e,g);d=this.Vj(d,c,f,!1,b,ao,this.s,this.ba);c=this.Vj(e,c,g,!1,b,bo,this.ga,this.S);this.D=d&&c;this.L||(this.L=this.K.rb());this.L.bounds=this.G(4,0);vm(this.K,this.L);this.L=null;this.gc&&(Mj(this.i,this.gc),this.gc=z);f<this.Gj?this.Ld=!0:this.Of&&(this.Ld=!1);this.Gj=f;this.Of=d;this.F&&this.F.after();Yn(this)};\nn.Vj=function(a,b,c,d,e,f,g){var h=Array.prototype.slice.call(arguments,6),k=h.length,l=h[0].ca.length,m=k*l,p=!!m,q;for(q=0;q<m;q++){if(f===ao){var r=q%k;var v=Math.floor(q/k)}else r=Math.floor(q/l),v=q%l;var w=h[r].ca[v];r=h[r].Uc;w&&(w=w.W(a,b,this.b,c,d,e,this.Ha),w===Ij.ACTIVE&&(this.Dd=Infinity),w!==Ij.DONE||r[v]||(Zn(this,this.g[v]),r[v]=!0),r[v]||(p=!1))}return p};function Zn(a,b){a.dispatchEvent({type:a.Tj.Zi,target:b||a})}\nn.u=function(){var a=this.f.Pa()[0],b=this.i;hk(this.Ig);Vn(this,!0);a&&bl(this,a,!1);Xn(this).forEach(function(c){c.C()});b.element&&b.element.removeChild(this.bb);this.bb=null;this.A=3;U.l.u.call(this)};n.ka=function(){this.ab=Vj();this.A===Ln&&(this.D=!1,this.A=1,Yn(this))};function co(a,b,c){Tn(a,b*a.na,c*a.na);a.I.set(0,0);dl(a);a.ka()}function Tn(a,b,c){var d=a.b;a=a.c;d.x=Qd(d.x+b,d.w);d.y=qd(0,pd(d.w,d.y+c));a.x=d.x/d.w;a.y=d.y/d.h}\nn.je=function(a,b,c){a=cl(this,cl(this,a)+this.ib);Un(this,a,b,c)};U.prototype.zoomAt=U.prototype.je;function Un(a,b,c,d){var e=a.na,f=a.i.center;c===+c&&d===+d?(c=(c-f.x)*e,d=(d-f.y)*e,a.I.set(c,d),Tn(a,c,d),a.b.Fa(b),Tn(a,-c,-d)):(a.I.set(0,0),a.b.Fa(b));a.zoom=b;dl(a);a.ka()}\nfunction Pn(a,b,c,d){var e=a.getCapabilities().lookAt.zoom.max,f=b.mb(),g=d||f;if(b.$f()||c&&d)c=c===B?e:c;else{var h=new Ph(a.b.projection);h.Fa(e);var k=h.lb(b.Vb()).round();var l=h.lb(b.Sb()).round();e=h.w;b.Ib()&&(k.x-=e);d?(f=h.lb(g),b=2*qd(f.x-k.x,l.x-f.x),k=2*qd(f.y-k.y,l.y-f.y)):(b=l.x-k.x,k=l.y-k.y,g=f);c===B&&(f=a.Lb[4],c=f.right-f.left,f=f.bottom-f.top,c=-8+pd(vd(c/b*e)/Fd,vd(f/k*e)/Fd)-a.ib,c=cl(a,c))}return{zoom:sd(c),position:g}}\nfunction Qn(a){Vn(a,!0);a.a.Ka()&&a.Bb(!0);a.m.Ka()&&a.Cb(!0);Vn(a,!0)}U.prototype.rc=function(a,b){Qn(this);eo(this,b);this.m.start(a,!!b)};U.prototype.startInteraction=U.prototype.rc;function eo(a,b){if(b){var c={};c.Xe=b.power;c.Jd=b.ease;c.duration=b.duration;a.o=c}}function Mn(a,b){return cl(a,cl(a,b-a.ib)+a.ib)}\nU.prototype.kc=function(a,b,c,d,e){var f=!1;this.m.Ka()&&(b=this.m.store(a,b,c,d,e),0<(this.m.b&al.COORD)&&(a=wl(this.m),0<tl(a)&&(co(this,-a.x,-a.y),f=!0)),b&&0<(this.m.b&al.ZOOM)&&(a=El(this.m),b=yl(this.m),b=vd(xd(2,this.zoom)*b)/Fd,b!==this.zoom&&(b=Mn(this,b),Un(this,b,a.x,a.y),f=!0)),f&&this.ka())};U.prototype.interaction=U.prototype.kc;\nU.prototype.Cb=function(a){var b=this;if(this.m.Ka()&&!a){if(this.o){a=Dl(this.m);var c=Bl(this.m);var d=this.o.duration;var e=(this.o.Xe||1)*a;var f=new im(-e/(0<d?d:1),e);!E(c.x)&&!E(c.y)&&0<e&&0<(b.m.b&al.COORD)&&Sn(this,function(g){e=f.Ge(g*d);E(e)||co(b,rd(-c.x*e),rd(-c.y*e))},d,void 0,this.o.Jd)}this.o=null;this.m.clear()}};U.prototype.endInteraction=U.prototype.Cb;U.prototype.qc=function(a,b,c){Qn(this);this.a.start(b,c);eo(this,a)};U.prototype.startControl=U.prototype.qc;\nU.prototype.control=function(a,b,c){if(E(+c))throw new D(this.control,2,c);if(E(a))throw new D(this.control,0,a);if(E(b))throw new D(this.control,1,b);this.a.Ka()&&this.a.set(a,b,c,0,0,0)};U.prototype.control=U.prototype.control;\nU.prototype.Bb=function(a,b){var c=this,d;if(this.a.Ka()){Vn(this,!0);var e=Vj();var f=e-this.ya;if(1<=f){var g=Ll(this.a);fo(this,g,f)}if(!this.o||a||b)\"function\"===typeof b&&(a=this.rb(),a.zoom=this.zoom-this.ib,b(a),a.zoom+=this.ib,go(this,a));else{b=Nl(Ll(this.a));var h=Ml(this.a);var k=this.o.duration;var l=(this.o.Xe||1)*b;var m=new im(-l/(0<k?k:1),l);!E(h.ub)&&!E(h.vb)&&0<l&&Sn(this,function(p,q,r,v){e&&(r=v-e,e=0);l=m.Ge(p*k)*r;E(l)||((d=h.wb*l)&&Un(c,Mn(c,c.zoom+d),c.a.b,c.a.c),co(c,rd(h.ub*\nl),rd(h.vb*l)))},k,void 0,this.o.Jd)}this.a.reset()}};U.prototype.endControl=U.prototype.Bb;\nfunction go(a,b){var c=a.c,d=a.b.projection.Rb(b.position),e=a.b.ad(d),f=e.y;e=e.x;var g=b.zoom;c=a.b.ad(c);b=c.y;var h=c.x;c=a.zoom;var k=Nl(Ll(a.a)),l=a.a.b,m=a.a.c,p=0;e=On(a,h,e);e-=h;f-=b;c=g-c;b=wd(e*e+f*f+c*c);if(0!==k&&0!==b){var q=e/b;var r=f/b;var v=c/b;var w=k*k/(2*b);Sn(a,function(y,H){var G;if(1!==y){y=k*H-w*H*H/2;H=y-p;if(G=v*H)G=Mn(a,a.zoom+G),Un(a,Mn(a,G),l,m);co(a,rd(q*H),rd(r*H));p=y}else a.c=d,Un(a,Mn(a,g),l,m),dl(a),a.ka()},2*b/k)}}\nU.prototype.Ed=function(a){var b=this,c=a.c;this.I.set(0,0);c.ub||c.vb||c.wb?(this.ya=Vj(),Sn(this,function(d,e,f,g){b.ya=g;fo(b,c,f)},Number.POSITIVE_INFINITY)):Vn(this,!0)};function fo(a,b,c){c=c||0;b.wb&&Un(a,Mn(a,a.zoom+b.wb*c),a.a.atX,a.a.atY);co(a,b.ub*c,b.vb*c)}function Sn(a,b,c,d,e){a.j&&a.j.Ka()&&a.j.stop(!0);a.j=new Wl(b,c,d,e);a.j.start()}function Vn(a,b){a.j&&a.j.Ka()&&a.j.stop(b)}U.prototype.bh=function(){};U.prototype.enter=U.prototype.bh;U.prototype.Mf=function(a){$k(this.bb,a)};\nU.prototype.exit=U.prototype.Mf;U.prototype.capture=function(a,b,c,d){var e=this.bb.ownerDocument.createElement(\"canvas\"),f=e.getContext(\"2d\"),g=this.na;e.width=(c-a)*g;e.height=(d-b)*g;for(c=0;c<this.v.length;c++)d=this.v[c],C(d,Rl)&&f.drawImage(d.J(),-a*g,-b*g);return Sb(e)};var bo=0,ao=1,Jn=1E3,$n=256;\n");