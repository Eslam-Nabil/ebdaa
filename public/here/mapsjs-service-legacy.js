
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.11.2/HERE_NOTICE
 */

H.service.util.eval("function kr(a){var b;if(a)for(this.a={},b=a.length;b--;)this.a[a[b]]=!0;this.Vk={}}var lr;kr.prototype.a={};kr.prototype.parse=function(a,b,c){var d,e,f,g,h;lr=!1;try{c=$o.JSON.parse(c)}catch(m){lr=!0}if(c&&(d=c.metadata)){var k={spatials:[]};for(e in d){if(c=!this.a[e]&&(f=mr[e]))(g=d[e])||(lr=!0,g=void 0),c=g;if(c)for(c=g.length;c--;){var l;(l=g[c])||(lr=!0,l=void 0);(h=l)&&f(b,a,this,e,h,k)}}}else lr=!0;return lr?void 0:k};kr.prototype.parse=kr.prototype.parse;\nvar mr={\"street labels\":function(a,b,c,d,e,f){var g;(g=e.vertices)||(lr=!0,g=void 0);if(g){var h,k=g.length,l;(l=0<k)||(lr=!0,l=void 0);if(l)for(h=Array(k/2);k;){var m=g[--k];l=g[--k];h[k/2]=new I(l,m)}h=h?{a:[h]}:B;k=+e[\"font size\"]/a.gb();g=c.Vk[k];g||(nr.lineWidth=k,g=c.Vk[k]=c.Hd.vj(nr));or(a,b,h,!1,g,e,d,f)}delete e.vertices},\"city center labels\":function(a,b,c,d,e,f){or(a,b,pr(e,new hh([])),!0,c.Hd,e,d,f)},labels:function(a,b,c,d,e,f){var g;(g=e[\"bounding boxes\"])||(lr=!0,g=void 0);if(g){for(var h=\ng.length,k=new hh([]),l;h--;){var m;(m=g[h])||(lr=!0,m=void 0);(l=m)&&pr(l,k)}or(a,b,k,!0,c.Hd,e,d,f)}delete e[\"bounding boxes\"]},buildings:function(a,b,c,d,e,f){var g=e.id,h=b.og[g],k,l,m,p=[],q=[];(k=e)||(lr=!0,k=void 0);if(k&&((l=k.vertices)||(lr=!0,l=void 0),l)){var r;(r=k.polygons)||(lr=!0,r=void 0);(m=r)&&p.push.apply(p,qr(l,m));(k=k.outlines)||(lr=!0,k=void 0);(m=k)&&q.push.apply(q,qr(l,m))}m=p.length;p.push.apply(p,q);q=new hh(p,Nd,m);(p=p.length)||(lr=!0,p=void 0);p&&(h?(aq(h,a,[q]),f.spatials.push(h)):\n(h=or(a,b,q,!0,c.Hd,e,d,f,g),b.$(h)))}};mr[\"transit stops\"]=mr.POIs=mr.labels;var rr=[\"box 2\",\"box 1\",\"annotation box\",\"icon box\"];function pr(a,b){for(var c=rr.length,d,e;c--;)if(d=rr[c],e=a[d]){var f=e[0],g=e[1],h=e[2];e=e[3];b.a.push([new I(f,g),new I(f+h,g),new I(f+h,g+e),new I(f,g+e)]);delete a[d]}return b}\nfunction qr(a,b){var c=b.length,d,e,f;if(0<c)for(e=Array(c);c--;)if((d=b[c])||(lr=!0,d=void 0),d){var g=d.length;if(0<g)for(e[c]=f=Array(g);g--;){var h=2*d[g];f[g]=new I(a[h],a[h+1])}}return e||[]}var sr={};function or(a,b,c,d,e,f,g,h,k){sr.style=e;d=new Xp(b,d,k,sr);c&&aq(d,a,[c]);tr(f);f.category=g;d.setData(f);h.spatials.push(d);d.da(b);return d}kr.prototype.Hd=new Kg({strokeColor:\"transparent\",fillColor:\"transparent\",lineWidth:0});var nr={};\nfunction tr(a){var b,c=!1;switch(typeof a){case \"object\":if(a instanceof Array)for(b=a.length;b--;)tr(a[b])?c=!0:delete a[b];else if(a)for(b in a)tr(a[b])?c=!0:delete a[b];break;case \"number\":c=!0;break;default:c=!!a}return c};function ur(a,b,c){c=c||{};b=b||{};var d=c.tileType||\"maptile\",e=c.scheme||\"normal.day\";Q.call(this,{min:0,max:20});!0===b.pois&&(b.pois=\"!F\");this.a=b;if(!(a&&a instanceof vr))throw Error(\"InvalidArgument: service required\");this.F=a;this.D=A(this.D,this);this.F.addEventListener(\"versionupdate\",this.D);this.b=a.Ja().clone().X(d+\"/\"+a.Ac()+\"/\"+e).V(this.I).V(b);this.ec=a.th()||null;this.S=c.pixelRatio||c.pixelratio||Ke();this.tileSize=c.tileSize||256;this.tileType=d;this.scheme=e;this.s=new Fp(new kr(c.categoryFilter));\nthis.s.da(this);this.L=A(this.L,this);this.s.addEventListener(\"update\",this.L);Q.call(this,{min:0,max:20});this.K(new bk(c.tileCacheSize||256,A(this.ya,this)))}u(ur,Q);t(\"H.service.metaInfo.TileProvider\",ur);ur.prototype.ya=function(a,b){a=b.fb();for(var c=a.length,d;c--;)d=a[c],delete d.cf[b.key],d.release();b.data&&(bp.push(b.mg(),this.tileSize),b.ng())};ur.prototype.L=function(){this.dispatchEvent(\"update\")};\nur.prototype.Qa=function(a,b,c,d,e){var f=this.b.clone(),g=this.ec,h=this.tileSize,k=this.getTileKey(a,b,c);k=this.Tb().get(k);var l;if(k&&!k.Zd()){d(bp.pop(this.tileSize),null);var m={cancel:function(){}}}else{g&&f.za(g[(c+b+a)%g.length]);f.X(c+\"/\"+a+\"/\"+b+\"/\"+h+\"/png8\");var p=$o.setTimeout(function(){l=(new jf(\"text/plain\",f.toString())).then(function(q){d(null,q)},e)},500)}return m||{cancel:function(){l?l.cancel():$o.clearTimeout(p)}}};ur.prototype.requestInternal=ur.prototype.Qa;\nur.prototype.kd=function(a,b,c,d,e){var f=this.s;var g=d||bp.pop(this.tileSize);if(d)a=this.Tb().get(this.getTileKey(a,b,c)),a.W(d);else if(d=a=new vk(this.Wd(a,b,c),a,b,c,this.tileSize,this.S,c,f),delete d.i,d.m=e,a.W(g))for(e=a.fb(),g=e.length;g--;)e[g].tg();else bp.push(g,this.tileSize);return a};ur.prototype.createTileInternal=ur.prototype.kd;ur.prototype.C=function(){this.s.C();this.F.removeEventListener(\"versionupdate\",this.D);Q.prototype.C.call(this)};\nur.prototype.D=function(){var a=this.F;this.b=a.Ja().clone().X(this.tileType+\"/\"+a.Ac()+\"/\"+this.scheme).V(this.I).V(this.a);this.reload(!1)};ur.prototype.I={metadata:\"metaonly\",mgen:\"2\"};function vr(a){var b=Uo({},this.ua,a||{});if(!vr.tb)throw new Sc(vr);if(!b.baseUrl&&!b.platformBaseUrl)throw new D(vr,0,'either \"baseUrl\" or \"platformBaseUrl\" must be specified');F.call(this);this.B=(b.baseUrl?b.baseUrl:b.platformBaseUrl).clone();this.Aa(b.baseUrl?a||{}:b);this.R=b.headers||{};this.ec=b.shards;(this.Ra=b.ignoreTypes?null:b.type)&&this.B.za(this.Ra);this.fc=b.version;this.ki={};this.Tc=new lp;\"newest\"===this.fc&&this.eh()}u(vr,F);t(\"H.service.metaInfo.Service\",vr);\nvr.prototype.ua={type:\"base\",version:\"newest\",subDomain:\"maps.ls\",path:\"maptile/2.1\",shards:[\"1\",\"2\",\"3\",\"4\"]};vr.CONFIG_KEY=\"metaInfo\";n=vr.prototype;n.Aa=function(a){a.subDomain&&this.B.za(a.subDomain);a.path&&this.B.kb(a.path);null!=a.useHTTPS&&this.B.Ei(a.useHTTPS?\"https\":\"http\")};n.pa=function(a,b,c){return(new jf(\"application/json\",a,Yd,{headers:this.R})).then(b,function(d){c(Error(\"[\"+d.statusText+\"] \"+a+\" request failed\"))})};\nfunction wr(a,b){for(var c={},d=a[b+\"s\"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+\"s\"]=c}n.Ja=function(){return this.B};n.th=function(){return this.ec};n.Cj=function(){return this.Ra};n.Ac=function(){return this.fc};vr.prototype.getVersion=vr.prototype.Ac;vr.prototype.Gi=function(a){this.fc=a};vr.prototype.qa=function(){return this.Tc};vr.prototype.getCopyrights=vr.prototype.qa;\nvr.prototype.Oi=function(a){a=a.response;var b;wr(a,\"map\");wr(a,\"scheme\");wr(a,\"tiletype\");wr(a,\"format\");wr(a,\"resolution\");wr(a,\"language\");if(\"newest\"===this.fc&&\"traffic\"!==this.Ra)for(b in a.maps)a.maps[b].hash&&a.maps[b].newest&&(this.Gi(a.maps[b].hash),this.dispatchEvent(\"versionupdate\"));this.Ah=a;this.dispatchEvent(\"infoupdate\")};\nvr.prototype.eh=function(){var a=this;var b=this.B.clone().X(\"info\").V({output:\"json\"});this.ec&&b.za(this.ec[0]);this.pa(b,function(c){a.Oi(c)},function(c){throw c;})};vr.prototype.nh=function(){return this.Ah};vr.prototype.getInfo=vr.prototype.nh;vr.prototype.xe=function(a,b,c,d,e,f){return new ur(this,d,{tileSize:a,pixelRatio:b,categoryFilter:c,tileType:e,scheme:f})};vr.prototype.createTileProvider=vr.prototype.xe;vr.prototype.tc=function(a,b,c,d,e,f){return new Kk(this.xe(a,b,c,d,e,f))};\nvr.prototype.createTileLayer=vr.prototype.tc;X.prototype.wj=function(a){return this.qb(vr,a)};X.prototype.getMetaInfoService=X.prototype.wj;(function(){var a=X.prototype.createDefaultLayers;X.prototype.createDefaultLayers=function(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g),k={},l=this.wj();\"object\"===typeof b&&(g=b,b=g.tileSize,c=g.ppi,d=g.lg,e=g.lg2,f=g.style,g=g.pois);b=b||256;var m=320===c?2:1;if(0>[72,250,320,500].indexOf(+c)){if(c!==B)throw new D(this.Vg,1,c);}else k.ppi=+c;d&&(k.lg=d);e&&(k.lg2=e);f&&(k.style=f);g&&(k.pois=g);h.raster.normal.metaInfo=l.tc(b,m,[\"buildings\"],k);return h}})();\n");